<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üöÄ Space Explorer</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #0b0c10;
      color: #fff;
    }

    header {
      text-align: center;
      padding: 20px;
      background: #1f2833;
    }

    nav {
      display: flex;
      justify-content: center;
      background: #141e27;
    }

    nav button {
      background: transparent;
      border: none;
      color: #66fcf1;
      padding: 15px 20px;
      cursor: pointer;
      font-size: 16px;
    }

    nav button.active {
      background: #45a29e;
      color: #fff;
    }

    section {
      display: none;
      padding: 20px;
      max-width: 1000px;
      margin: auto;
    }

    section.active {
      display: block;
    }

    img, iframe {
      max-width: 100%;
      border-radius: 10px;
    }

    .media-item {
      margin-top: 20px;
    }

    .gallery {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 15px;
      margin-top: 20px;
    }

    .card {
      background: #1f2833;
      padding: 10px;
      border-radius: 10px;
    }

    .card img {
      width: 100%;
      border-radius: 10px;
    }

    .card p {
      font-size: 14px;
    }
  </style>
</head>
<body>
  <header>
    <h1>üöÄ Space Explorer</h1>
    <p>Explore the Universe using NASA APIs</p>
  </header>

  <nav>
    <button class="tab active" onclick="switchTab('apod')">üìÖ APOD</button>
    <button class="tab" onclick="switchTab('search')">üîç Search</button>
    <button class="tab" onclick="switchTab('mars')">üìç Mars Rover</button>
    <button class="tab" onclick="switchTab('favorites')">‚ù§Ô∏è Favorites</button>
  </nav>

  <section id="apod" class="active">
    <h2>NASA Astronomy Picture of the Day</h2>
    <input type="date" id="apod-date" max="" />
    <button onclick="loadAPOD()">Load</button>
    <button onclick="saveFavorite()">‚ù§Ô∏è Save</button>
    <div class="media-item" id="apod-result"></div>
  </section>

  <section id="search">
    <h2>NASA Media Search</h2>
    <input type="text" id="search-query" placeholder="e.g. moon, mars, galaxy...">
    <button onclick="searchMedia()">Search</button>
    <div class="gallery" id="search-results"></div>
  </section>

  <section id="mars">
    <h2>Mars Rover Photos</h2>
    <label for="rover">Rover:</label>
    <select id="rover">
      <option value="curiosity">Curiosity</option>
      <option value="opportunity">Opportunity</option>
      <option value="spirit">Spirit</option>
    </select>
    <input type="date" id="mars-date" max="">
    <button onclick="loadMarsPhotos()">Load Photos</button>
    <div class="gallery" id="mars-results"></div>
  </section>

  <section id="favorites">
    <h2>‚ù§Ô∏è Your Favorite APODs</h2>
    <div class="gallery" id="favorites-list"></div>
  </section>

  <script>
    const today = new Date().toISOString().split("T")[0];
    document.getElementById("apod-date").max = today;
    document.getElementById("apod-date").value = today;
    document.getElementById("mars-date").max = today;
    document.getElementById("mars-date").value = today;

    const apodResult = document.getElementById("apod-result");
    let currentAPOD = {};

    function switchTab(tabId) {
      document.querySelectorAll(".tab").forEach(btn => btn.classList.remove("active"));
      document.querySelectorAll("section").forEach(sec => sec.classList.remove("active"));
      document.querySelector(`button[onclick*='${tabId}']`).classList.add("active");
      document.getElementById(tabId).classList.add("active");
      if (tabId === "favorites") loadFavorites();
    }

    async function loadAPOD() {
      const date = document.getElementById("apod-date").value;
      const res = await fetch(`https://api.nasa.gov/planetary/apod?api_key=DEMO_KEY&date=${date}`);
      const data = await res.json();
      currentAPOD = data;
      apodResult.innerHTML = `
        <h3>${data.title}</h3>
        <p>${data.date}</p>
        ${data.media_type === 'image' ? `<img src="${data.url}" alt="${data.title}">` : `<iframe src="${data.url}" height="400"></iframe>`}
        <p>${data.explanation}</p>
      `;
    }

    function saveFavorite() {
      if (!currentAPOD.date) return alert("Load an APOD first!");
      let favorites = JSON.parse(localStorage.getItem("favorites")) || [];
      if (!favorites.find(f => f.date === currentAPOD.date)) {
        favorites.push(currentAPOD);
        localStorage.setItem("favorites", JSON.stringify(favorites));
        alert("Saved to favorites!");
      } else {
        alert("Already in favorites!");
      }
    }

    function loadFavorites() {
      const favorites = JSON.parse(localStorage.getItem("favorites")) || [];
      const container = document.getElementById("favorites-list");
      container.innerHTML = "";
      favorites.forEach(item => {
        container.innerHTML += `
          <div class="card">
            <img src="${item.url}" alt="${item.title}">
            <p><strong>${item.title}</strong><br>${item.date}</p>
          </div>
        `;
      });
    }

    async function searchMedia() {
      const query = document.getElementById("search-query").value;
      const res = await fetch(`https://images-api.nasa.gov/search?q=${query}`);
      const data = await res.json();
      const items = data.collection.items.slice(0, 12);
      const results = document.getElementById("search-results");
      results.innerHTML = "";
      items.forEach(item => {
        const img = item.links?.[0]?.href;
        const title = item.data?.[0]?.title;
        if (img && title) {
          results.innerHTML += `
            <div class="card">
              <img src="${img}" alt="${title}">
              <p>${title}</p>
            </div>
          `;
        }
      });
    }

    async function loadMarsPhotos() {
      const rover = document.getElementById("rover").value;
      const date = document.getElementById("mars-date").value;
      const res = await fetch(`https://api.nasa.gov/mars-photos/api/v1/rovers/${rover}/photos?earth_date=${date}&api_key=DEMO_KEY`);
      const data = await res.json();
      const container = document.getElementById("mars-results");
      container.innerHTML = "";
      data.photos.slice(0, 12).forEach(photo => {
        container.innerHTML += `
          <div class="card">
            <img src="${photo.img_src}" alt="Mars Photo">
            <p>${photo.rover.name} - ${photo.earth_date}</p>
          </div>
        `;
      });
    }

    // Initial load
    loadAPOD();
  </script>
</body>
</html>
